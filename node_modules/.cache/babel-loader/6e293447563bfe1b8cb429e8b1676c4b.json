{"ast":null,"code":"import { createElementVNode as _createElementVNode, vModelText as _vModelText, withKeys as _withKeys, withDirectives as _withDirectives, resolveComponent as _resolveComponent, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, createBlock as _createBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-3e721a5c\"), n = n(), _popScopeId(), n);\n\nconst _hoisted_1 = {\n  class: \"container\"\n};\nconst _hoisted_2 = {\n  class: \"d-flex justify-content-between mb-3\"\n};\n\nconst _hoisted_3 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"h2\", {\n  class: \"strong\"\n}, \"To-Do List\", -1\n/* HOISTED */\n));\n\nconst _hoisted_4 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"hr\", null, null, -1\n/* HOISTED */\n));\n\nconst _hoisted_5 = {\n  key: 0\n};\n\nconst _hoisted_6 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"hr\", null, null, -1\n/* HOISTED */\n));\n\nconst _hoisted_7 = {\n  \"aria-label\": \"Page navigation example\"\n};\nconst _hoisted_8 = {\n  class: \"pagination\"\n};\n\nconst _hoisted_9 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"a\", {\n  class: \"page-link\"\n}, \"Previous\", -1\n/* HOISTED */\n));\n\nconst _hoisted_10 = [_hoisted_9];\nconst _hoisted_11 = [\"onClick\"];\nconst _hoisted_12 = {\n  class: \"page-link\",\n  href: \"#\"\n};\n\nconst _hoisted_13 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"a\", {\n  class: \"page-link\"\n}, \"Next\", -1\n/* HOISTED */\n));\n\nconst _hoisted_14 = [_hoisted_13];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_TodoSimpleForm = _resolveComponent(\"TodoSimpleForm\");\n\n  const _component_TodoList = _resolveComponent(\"TodoList\");\n\n  const _component_Toast = _resolveComponent(\"Toast\");\n\n  return _openBlock(), _createElementBlock(\"div\", null, [_createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_hoisted_3, _createElementVNode(\"button\", {\n    class: \"btn btn-primary\",\n    onClick: _cache[0] || (_cache[0] = (...args) => $setup.goToCreate && $setup.goToCreate(...args))\n  }, \"Create\")]), _withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    class: \"form-control\",\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.searchText = $event),\n    placeholder: \"Search\",\n    onKeyup: _cache[2] || (_cache[2] = _withKeys((...args) => $setup.searchTodo && $setup.searchTodo(...args), [\"enter\"]))\n  }, null, 544\n  /* HYDRATE_EVENTS, NEED_PATCH */\n  ), [[_vModelText, $setup.searchText]]), _hoisted_4, _createVNode(_component_TodoSimpleForm, {\n    onAddTodo: $setup.addTodo\n  }, null, 8\n  /* PROPS */\n  , [\"onAddTodo\"]), !$setup.filteredTodos.length ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, \" Nothing \")) : _createCommentVNode(\"v-if\", true), _createVNode(_component_TodoList, {\n    todos: $setup.filteredTodos,\n    onToggleTodo: $setup.toggleTodo,\n    onDeleteTodo: $setup.deleteTodo\n  }, null, 8\n  /* PROPS */\n  , [\"todos\", \"onToggleTodo\", \"onDeleteTodo\"]), _hoisted_6, _createElementVNode(\"nav\", _hoisted_7, [_createElementVNode(\"ul\", _hoisted_8, [_createElementVNode(\"li\", {\n    class: \"page-item\",\n    onClick: _cache[3] || (_cache[3] = $event => {\n      $setup.getTodo($setup.curPage - 1);\n      $setup.curPage = $setup.curPage - 1;\n    })\n  }, _hoisted_10), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.numOfPages, page => {\n    return _openBlock(), _createElementBlock(\"li\", {\n      key: page,\n      class: _normalizeClass([$setup.curPage === page ? 'active' : '', \"page-item\"]),\n      onClick: $event => {\n        $setup.getTodo(page);\n        $setup.curPage = page;\n      }\n    }, [_createElementVNode(\"a\", _hoisted_12, _toDisplayString(page), 1\n    /* TEXT */\n    )], 10\n    /* CLASS, PROPS */\n    , _hoisted_11);\n  }), 128\n  /* KEYED_FRAGMENT */\n  )), _createElementVNode(\"li\", {\n    class: \"page-item\",\n    onClick: _cache[4] || (_cache[4] = $event => {\n      $setup.getTodo($setup.curPage + 1);\n      $setup.curPage = $setup.curPage + 1;\n    })\n  }, _hoisted_14)])])]), $setup.showToast ? (_openBlock(), _createBlock(_component_Toast, {\n    key: 0,\n    style: {\n      \"z-index\": \"1050\"\n    },\n    message: $setup.toastMessage,\n    type: $setup.toastAlertType\n  }, null, 8\n  /* PROPS */\n  , [\"message\", \"type\"])) : _createCommentVNode(\"v-if\", true)]);\n}","map":{"version":3,"mappings":";;;;;AAGMA,OAAK,EAAC;;;AACHA,OAAK,EAAC;;;gEACTC,oBAAkC,IAAlC,EAAkC;AAA9BD,OAAK,EAAC;AAAwB,CAAlC,EAAmB,YAAnB,EAA6B;AAAA;AAA7B;;gEASFC,oBAAI,IAAJ,EAAI,IAAJ,EAAI,IAAJ,EAAI;AAAA;AAAJ;;;;;;gEAQAA,oBAAI,IAAJ,EAAI,IAAJ,EAAI,IAAJ,EAAI;AAAA;AAAJ;;;AACK,gBAAW;;;AACVD,OAAK,EAAC;;;gEAENC,oBAAkC,GAAlC,EAAkC;AAA/BD,OAAK,EAAC;AAAyB,CAAlC,EAAsB,UAAtB,EAA8B;AAAA;AAA9B;;qBAAAE;;;AAKmBF,OAAK,EAAC;AAAYG,MAAI,EAAC;;;iEAG1CF,oBAA8B,GAA9B,EAA8B;AAA3BD,OAAK,EAAC;AAAqB,CAA9B,EAAsB,MAAtB,EAA0B;AAAA;AAA1B;;qBAAAI;;;;;;;;uBAhCVC,oBA0CM,KA1CN,EA0CM,IA1CN,EA0CM,CAzCLJ,oBAkCO,KAlCP,cAkCO,CAjCJA,oBAMM,KANN,cAMM,CALJK,UAKI,EAFJL,oBACmC,QADnC,EACmC;AAD3BD,SAAK,EAAC,iBACqB;AAAlCO,WAAK,yCAAEC,+CAAF;AAA6B,GADnC,EACoB,QADpB,CAEI,CANN,CAiCI,kBA1BJP,oBAE0B,OAF1B,EAE0B;AAFnBQ,QAAI,EAAC,MAEc;AAFPT,SAAK,EAAC,cAEC;+DADjBQ,oBAAUE,OACO;AADLC,eAAW,EAAC,QACP;AAAzBC,WAAK,mDAAQJ,+CAAR,EAAkB,SAAlB;AAAoB,GAF1B;;AAAA,oBACSA,oBAyBL,EAvBJK,UAuBI,EAtBJC,aAAqDC,yBAArD,EAAqD;AAApCC,aAAQ,EAAER;AAA0B,GAArD,EAAkC,IAAlC,EAAkC;AAAA;AAAlC,IAAkC,aAAlC,CAsBI,GArBQA,qBAAcS,wBAA1BZ,oBAAiD,KAAjD,EAAiDa,UAAjD,EAAkC,WAAlC,sCAqBI,EApBJJ,aAGWK,mBAHX,EAGW;AAHAC,SAAK,EAAEZ,oBAGP;AAFRa,gBAAW,EAAEb,iBAEL;AADRc,gBAAW,EAAEd;AACL,GAHX;;AAAA,8CAoBI,EAfJe,UAeI,EAdJtB,oBAaM,KAbN,cAaM,CAZJA,oBAWK,IAXL,cAWK,CAVHA,oBACyC,IADzC,EACyC;AADrCD,SAAK,EAAC,WAC+B;AADlBO,WAAK;AAAEC,qBAAQA,iBAAO,CAAf;AAAmBA,uBAAUA,iBAAO,CAAjB;AAAiB,KAAtC;AACa,GADzC,cAUG,qBAPHH,oBAGmEmB,SAHnE,EAGmE,IAHnE,EAGmEC,YAHhDjB,iBAGgD,EAHxDkB,IAAkB,IAAd;yBAAfrB,oBAGmE,IAHnE,EAGmE;AAFlEsB,SAAG,EAAED,IAE6D;AAFtD1B,WAAK,mBAAEQ,mBAAYkB,IAAZ,GAAgB,QAAhB,GAAgB,EAAlB,EAEZ,WAFY,EAEiD;AADlEnB,aAAK;AAAEC,uBAAQkB,IAAR;AAAelB,yBAAUkB,IAAV;AAAc;AAC8B,KAHnE,GAGkBzB,oBAA4C,GAA5C,eAA4C2B,iBAAXF,IAAW,CAA5C,EAAqC;AAAA;AAArC,MAHlB;;AAAA;GAGmE,CAHnE;;AAAA,GAOG,GAFHzB,oBACqC,IADrC,EACqC;AADjCD,SAAK,EAAC,WAC2B;AADdO,WAAK;AAAEC,qBAAQA,iBAAO,CAAf;AAAoBA,uBAAUA,iBAAO,CAAjB;AAAiB,KAAvC;AACS,GADrC,cAEG,CAXL,CAYI,CAbN,CAcI,CAlCP,CAyCK,EALYA,kCADVqB,aAIEC,gBAJF,EAIE;UAAA;AAJKC,SAAsB,EAAtB;AAAA;AAAA,KAIL;AAFGC,WAAO,EAAExB,mBAEZ;AADGC,QAAI,EAAED;AACT,GAJF;;AAAA,6DAMF,CA1CN","names":["class","_createElementVNode","_hoisted_9","href","_hoisted_13","_createElementBlock","_hoisted_3","onClick","$setup","type","$event","placeholder","onKeyup","_hoisted_4","_createVNode","_component_TodoSimpleForm","onAddTodo","length","_hoisted_5","_component_TodoList","todos","onToggleTodo","onDeleteTodo","_hoisted_6","_Fragment","_renderList","page","key","_toDisplayString","_createBlock","_component_Toast","style","message"],"sourceRoot":"","sources":["E:\\vue\\vue_todo\\src\\pages\\todos\\index.vue"],"sourcesContent":["<template>\r\n\r\n<div>\r\n <div class=\"container\">\r\n    <div class=\"d-flex justify-content-between mb-3\">\r\n      <h2 class=\"strong\">To-Do List</h2>\r\n\r\n\r\n      <button class=\"btn btn-primary\"\r\n      @click=\"goToCreate\">Create</button>\r\n    </div>\r\n    <input type=\"text\" class=\"form-control\" \r\n    v-model=\"searchText\" placeholder=\"Search\"\r\n    @keyup.enter=\"searchTodo\">\r\n    <hr>\r\n    <TodoSimpleForm @add-todo=\"addTodo\"></TodoSimpleForm>\r\n    <div v-if=\"!filteredTodos.length\"> Nothing </div>\r\n    <TodoList :todos=\"filteredTodos\" \r\n      @toggle-todo=\"toggleTodo\" \r\n      @delete-todo=\"deleteTodo\">\r\n    </TodoList>\r\n\r\n    <hr>\r\n    <nav aria-label=\"Page navigation example\">\r\n      <ul class=\"pagination\">\r\n        <li class=\"page-item\" @click='getTodo(curPage-1);curPage = curPage-1'>\r\n          <a class=\"page-link\" >Previous</a></li>\r\n       \r\n        <li v-for=\"page in numOfPages\" \r\n        :key=\"page\" :class=\"curPage === page? 'active':''\"\r\n        @click='getTodo(page); curPage = page'\r\n        class=\"page-item\"><a class=\"page-link\" href=\"#\">{{ page }}</a></li>\r\n\r\n        <li class=\"page-item\" @click='getTodo(curPage+1); curPage = curPage+1'>\r\n          <a class=\"page-link\" >Next</a></li>\r\n      </ul>\r\n    </nav>\r\n  </div>\r\n        <Toast style=\"z-index: 1050;\"\r\n            v-if=\"showToast\"\r\n            :message=\"toastMessage\"\r\n            :type=\"toastAlertType\"\r\n        />\r\n\r\n</div>\r\n\r\n \r\n</template>\r\n\r\n<script>\r\n  import {\r\n    ref,\r\n    computed,\r\n    watch\r\n  } from 'vue'\r\n  import TodoSimpleForm from '@/components/TodoSimpleForm.vue'\r\n  import TodoList from '@/components/TodoList.vue'\r\n  import axios from 'axios'\r\n  import Toast from '@/components/Toast.vue';\r\n  import { useToast } from '@/composables/toast';\r\n  import { useRouter } from 'vue-router'\r\n\r\n\r\n  export default {\r\n    name: 'App',\r\n    components: {\r\n      TodoSimpleForm,\r\n      TodoList,\r\n      Toast\r\n\r\n    },\r\n    setup() {\r\n      const toggle = ref(false);\r\n\r\n      const todos = ref([]);\r\n      const numOfTodos = ref(0);\r\n      const limit = 5;\r\n      const curPage = ref(1);\r\n      const searchText = ref('');\r\n\r\n      const router = useRouter()\r\n\r\n\r\n      const numOfPages = computed(()=>{\r\n        return Math.ceil(numOfTodos.value/limit)\r\n      })\r\n\r\n      const {\r\n        showToast,\r\n        toastMessage,\r\n        toastAlertType,\r\n        triggerToast,\r\n\r\n      } = useToast() \r\n\r\n      const getTodo = async (page = curPage.value) => {\r\n        //curPage.value = page;\r\n        try {\r\n          console.log(page)\r\n          const res = await axios.get(\r\n            `http://localhost:3000/todos?_sort=id&_order=desc&subject_like=${searchText.value}&_page=${page}&_limit=${limit}`\r\n            )\r\n          todos.value = res.data;\r\n          numOfTodos.value = res.headers['x-total-count'];\r\n        } catch (err) {\r\n          console.error(err)\r\n          let msg = '';\r\n            msg = err\r\n          triggerToast(msg, 'danger');\r\n        }\r\n      }\r\n      getTodo();\r\n\r\n      const addTodo = async (todo) => {\r\n        try {\r\n          const res = await axios.post('http://localhost:3000/todos', {\r\n            subject: todo.subject,\r\n            completed: todo.completed,\r\n          })\r\n          todos.value.push(res.data);\r\n          getTodo();\r\n        } catch (err) {\r\n          console.error(err)\r\n          triggerToast(err, 'danger');\r\n        }\r\n\r\n      }\r\n      const deleteTodo = async (index) => {\r\n        const id = todos.value[index].id;\r\n        try {\r\n          await axios.delete('http://localhost:3000/todos/' + id)\r\n\r\n          getTodo(1);\r\n\r\n        } catch (err) {\r\n          console.error(err)\r\n          triggerToast(err, 'danger');\r\n        }\r\n\r\n      }\r\n      const onToggle = () => {\r\n        toggle.value = !toggle.value;\r\n      };\r\n\r\n      const toggleTodo = async (index, checked) => {\r\n        const id = todos.value[index].id;\r\n        try {\r\n          await axios.patch('http://localhost:3000/todos/' + id, {\r\n            //completed: !todos.value[index].completed\r\n            completed: checked\r\n          })\r\n          //todos.value[index].completed = !todos.value[index].completed\r\n          todos.value[index].completed = checked\r\n\r\n        } catch (err) {\r\n          console.error(err)\r\n          triggerToast(err, 'danger');\r\n        }\r\n      }\r\n\r\n      const goToCreate = () => {\r\n        router.push({name:'TodoCreate'})\r\n      }\r\n\r\n      let timeout= null;\r\n      const searchTodo = () => {\r\n         getTodo(1);\r\n      }\r\n\r\n\r\n      watch(searchText, () => {\r\n        clearTimeout(timeout);\r\n        timeout = setTimeout(()=>{\r\n          getTodo(1);\r\n        }, 1000)\r\n      })\r\n\r\n  \r\n      const filteredTodos = computed(() => {\r\n        if (searchText.value) {\r\n          return todos.value.filter(todo => {\r\n            return todo.subject.includes(searchText.value)\r\n          });\r\n        }\r\n        return todos.value;\r\n      })\r\n\r\n      \r\n      // const showToast = ref(false);\r\n      // const toastMessage = ref('');\r\n      // const toastAlertType = ref('');\r\n\r\n\r\n      // const toastTimeout = ref(null);\r\n      // const triggerToast = (message, type = 'success') => {\r\n      //     showToast.value = true;\r\n      //     toastAlertType.value=type;\r\n      //     toastMessage.value=message;\r\n\r\n      //     toastTimeout.value = setTimeout(() => {\r\n\r\n      //       toastMessage.value='';\r\n      //       showToast.value= false;\r\n      //       toastAlertType.value='';\r\n            \r\n      //     }, 3000)\r\n      //   };\r\n\r\n\r\n      return {\r\n        searchTodo,\r\n        todos,\r\n        getTodo,\r\n        addTodo,\r\n        deleteTodo,\r\n        toggleTodo,\r\n        onToggle,\r\n        toggle,\r\n        searchText,\r\n        filteredTodos,\r\n        numOfPages,\r\n        curPage,\r\n        Toast,\r\n        showToast,\r\n        toastMessage,\r\n        toastAlertType,\r\n        goToCreate,\r\n\r\n      }\r\n    },\r\n  }\r\n</script>\r\n\r\n<style scoped>\r\nnav a{\r\n  cursor:pointer;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}