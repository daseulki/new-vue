{"ast":null,"code":"import { createElementVNode as _createElementVNode, vModelText as _vModelText, withKeys as _withKeys, withDirectives as _withDirectives, resolveComponent as _resolveComponent, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, createBlock as _createBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-3e721a5c\"), n = n(), _popScopeId(), n);\n\nconst _hoisted_1 = {\n  class: \"container\"\n};\n\nconst _hoisted_2 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"h2\", {\n  class: \"strong\"\n}, \"To-Do List\", -1\n/* HOISTED */\n));\n\nconst _hoisted_3 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"hr\", null, null, -1\n/* HOISTED */\n));\n\nconst _hoisted_4 = {\n  key: 0\n};\n\nconst _hoisted_5 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"hr\", null, null, -1\n/* HOISTED */\n));\n\nconst _hoisted_6 = {\n  \"aria-label\": \"Page navigation example\"\n};\nconst _hoisted_7 = {\n  class: \"pagination\"\n};\n\nconst _hoisted_8 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"a\", {\n  class: \"page-link\"\n}, \"Previous\", -1\n/* HOISTED */\n));\n\nconst _hoisted_9 = [_hoisted_8];\nconst _hoisted_10 = [\"onClick\"];\nconst _hoisted_11 = {\n  class: \"page-link\",\n  href: \"#\"\n};\n\nconst _hoisted_12 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"a\", {\n  class: \"page-link\"\n}, \"Next\", -1\n/* HOISTED */\n));\n\nconst _hoisted_13 = [_hoisted_12];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_TodoSimpleForm = _resolveComponent(\"TodoSimpleForm\");\n\n  const _component_TodoList = _resolveComponent(\"TodoList\");\n\n  const _component_Toast = _resolveComponent(\"Toast\");\n\n  return _openBlock(), _createElementBlock(\"div\", null, [_createElementVNode(\"div\", _hoisted_1, [_hoisted_2, _withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    class: \"form-control\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.searchText = $event),\n    placeholder: \"Search\",\n    onKeyup: _cache[1] || (_cache[1] = _withKeys((...args) => $setup.searchTodo && $setup.searchTodo(...args), [\"enter\"]))\n  }, null, 544\n  /* HYDRATE_EVENTS, NEED_PATCH */\n  ), [[_vModelText, $setup.searchText]]), _hoisted_3, _createVNode(_component_TodoSimpleForm, {\n    onAddTodo: $setup.addTodo\n  }, null, 8\n  /* PROPS */\n  , [\"onAddTodo\"]), !$setup.filteredTodos.length ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, \" Nothing \")) : _createCommentVNode(\"v-if\", true), _createVNode(_component_TodoList, {\n    todos: $setup.filteredTodos,\n    onToggleTodo: $setup.toggleTodo,\n    onDeleteTodo: $setup.deleteTodo\n  }, null, 8\n  /* PROPS */\n  , [\"todos\", \"onToggleTodo\", \"onDeleteTodo\"]), _hoisted_5, _createElementVNode(\"nav\", _hoisted_6, [_createElementVNode(\"ul\", _hoisted_7, [_createElementVNode(\"li\", {\n    class: \"page-item\",\n    onClick: _cache[2] || (_cache[2] = $event => {\n      $setup.getTodo($setup.curPage - 1);\n      $setup.curPage = $setup.curPage - 1;\n    })\n  }, _hoisted_9), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.numOfPages, page => {\n    return _openBlock(), _createElementBlock(\"li\", {\n      key: page,\n      class: _normalizeClass([$setup.curPage === page ? 'active' : '', \"page-item\"]),\n      onClick: $event => {\n        $setup.getTodo(page);\n        $setup.curPage = page;\n      }\n    }, [_createElementVNode(\"a\", _hoisted_11, _toDisplayString(page), 1\n    /* TEXT */\n    )], 10\n    /* CLASS, PROPS */\n    , _hoisted_10);\n  }), 128\n  /* KEYED_FRAGMENT */\n  )), _createElementVNode(\"li\", {\n    class: \"page-item\",\n    onClick: _cache[3] || (_cache[3] = $event => {\n      $setup.getTodo($setup.curPage + 1);\n      $setup.curPage = $setup.curPage + 1;\n    })\n  }, _hoisted_13)])])]), $setup.showToast ? (_openBlock(), _createBlock(_component_Toast, {\n    key: 0,\n    message: $setup.toastMessage,\n    type: $setup.toastAlertType\n  }, null, 8\n  /* PROPS */\n  , [\"message\", \"type\"])) : _createCommentVNode(\"v-if\", true)]);\n}","map":{"version":3,"mappings":";;;;;AAGMA,OAAK,EAAC;;;gEACRC,oBAAkC,IAAlC,EAAkC;AAA9BD,OAAK,EAAC;AAAwB,CAAlC,EAAmB,YAAnB,EAA6B;AAAA;AAA7B;;gEAIAC,oBAAI,IAAJ,EAAI,IAAJ,EAAI,IAAJ,EAAI;AAAA;AAAJ;;;;;;gEAQAA,oBAAI,IAAJ,EAAI,IAAJ,EAAI,IAAJ,EAAI;AAAA;AAAJ;;;AACK,gBAAW;;;AACVD,OAAK,EAAC;;;gEAENC,oBAAkC,GAAlC,EAAkC;AAA/BD,OAAK,EAAC;AAAyB,CAAlC,EAAsB,UAAtB,EAA8B;AAAA;AAA9B;;oBAAAE;;;AAKmBF,OAAK,EAAC;AAAYG,MAAI,EAAC;;;iEAG1CF,oBAA8B,GAA9B,EAA8B;AAA3BD,OAAK,EAAC;AAAqB,CAA9B,EAAsB,MAAtB,EAA0B;AAAA;AAA1B;;qBAAAI;;;;;;;;uBA1BVC,oBAoCM,KApCN,EAoCM,IApCN,EAoCM,CAnCLJ,oBA4BO,KA5BP,cA4BO,CA3BJK,UA2BI,kBA1BJL,oBAE0B,OAF1B,EAE0B;AAFnBM,QAAI,EAAC,MAEc;AAFPP,SAAK,EAAC,cAEC;+DADjBQ,oBAAUC,OACO;AADLC,eAAW,EAAC,QACP;AAAzBC,WAAK,mDAAQH,+CAAR,EAAkB,SAAlB;AAAoB,GAF1B;;AAAA,oBACSA,oBAyBL,EAvBJI,UAuBI,EAtBJC,aAAqDC,yBAArD,EAAqD;AAApCC,aAAQ,EAAEP;AAA0B,GAArD,EAAkC,IAAlC,EAAkC;AAAA;AAAlC,IAAkC,aAAlC,CAsBI,GArBQA,qBAAcQ,wBAA1BX,oBAAiD,KAAjD,EAAiDY,UAAjD,EAAkC,WAAlC,sCAqBI,EApBJJ,aAGWK,mBAHX,EAGW;AAHAC,SAAK,EAAEX,oBAGP;AAFRY,gBAAW,EAAEZ,iBAEL;AADRa,gBAAW,EAAEb;AACL,GAHX;;AAAA,8CAoBI,EAfJc,UAeI,EAdJrB,oBAaM,KAbN,cAaM,CAZJA,oBAWK,IAXL,cAWK,CAVHA,oBACyC,IADzC,EACyC;AADrCD,SAAK,EAAC,WAC+B;AADlBuB,WAAK;AAAEf,qBAAQA,iBAAO,CAAf;AAAmBA,uBAAUA,iBAAO,CAAjB;AAAiB,KAAtC;AACa,GADzC,aAUG,qBAPHH,oBAGmEmB,SAHnE,EAGmE,IAHnE,EAGmEC,YAHhDjB,iBAGgD,EAHxDkB,IAAkB,IAAd;yBAAfrB,oBAGmE,IAHnE,EAGmE;AAFlEsB,SAAG,EAAED,IAE6D;AAFtD1B,WAAK,mBAAEQ,mBAAYkB,IAAZ,GAAgB,QAAhB,GAAgB,EAAlB,EAEZ,WAFY,EAEiD;AADlEH,aAAK;AAAEf,uBAAQkB,IAAR;AAAelB,yBAAUkB,IAAV;AAAc;AAC8B,KAHnE,GAGkBzB,oBAA4C,GAA5C,eAA4C2B,iBAAXF,IAAW,CAA5C,EAAqC;AAAA;AAArC,MAHlB;;AAAA;GAGmE,CAHnE;;AAAA,GAOG,GAFHzB,oBACqC,IADrC,EACqC;AADjCD,SAAK,EAAC,WAC2B;AADduB,WAAK;AAAEf,qBAAQA,iBAAO,CAAf;AAAoBA,uBAAUA,iBAAO,CAAjB;AAAiB,KAAvC;AACS,GADrC,cAEG,CAXL,CAYI,CAbN,CAcI,CA5BP,CAmCK,EALYA,kCADVqB,aAIEC,gBAJF,EAIE;UAAA;AAFGC,WAAO,EAAEvB,mBAEZ;AADGD,QAAI,EAAEC;AACT,GAJF;;AAAA,6DAMF,CApCN","names":["class","_createElementVNode","_hoisted_8","href","_hoisted_12","_createElementBlock","_hoisted_2","type","$setup","$event","placeholder","onKeyup","_hoisted_3","_createVNode","_component_TodoSimpleForm","onAddTodo","length","_hoisted_4","_component_TodoList","todos","onToggleTodo","onDeleteTodo","_hoisted_5","onClick","_Fragment","_renderList","page","key","_toDisplayString","_createBlock","_component_Toast","message"],"sourceRoot":"","sources":["E:\\vue\\vue_todo\\src\\pages\\todos\\index.vue"],"sourcesContent":["<template>\r\n\r\n<div>\r\n <div class=\"container\">\r\n    <h2 class=\"strong\">To-Do List</h2>\r\n    <input type=\"text\" class=\"form-control\" \r\n    v-model=\"searchText\" placeholder=\"Search\"\r\n    @keyup.enter=\"searchTodo\">\r\n    <hr>\r\n    <TodoSimpleForm @add-todo=\"addTodo\"></TodoSimpleForm>\r\n    <div v-if=\"!filteredTodos.length\"> Nothing </div>\r\n    <TodoList :todos=\"filteredTodos\" \r\n      @toggle-todo=\"toggleTodo\" \r\n      @delete-todo=\"deleteTodo\">\r\n    </TodoList>\r\n\r\n    <hr>\r\n    <nav aria-label=\"Page navigation example\">\r\n      <ul class=\"pagination\">\r\n        <li class=\"page-item\" @click='getTodo(curPage-1);curPage = curPage-1'>\r\n          <a class=\"page-link\" >Previous</a></li>\r\n       \r\n        <li v-for=\"page in numOfPages\" \r\n        :key=\"page\" :class=\"curPage === page? 'active':''\"\r\n        @click='getTodo(page); curPage = page'\r\n        class=\"page-item\"><a class=\"page-link\" href=\"#\">{{ page }}</a></li>\r\n\r\n        <li class=\"page-item\" @click='getTodo(curPage+1); curPage = curPage+1'>\r\n          <a class=\"page-link\" >Next</a></li>\r\n      </ul>\r\n    </nav>\r\n  </div>\r\n        <Toast \r\n            v-if=\"showToast\"\r\n            :message=\"toastMessage\"\r\n            :type=\"toastAlertType\"\r\n        />\r\n\r\n</div>\r\n\r\n \r\n</template>\r\n\r\n<script>\r\n  import {\r\n    ref,\r\n    computed,\r\n    watch\r\n  } from 'vue'\r\n  import TodoSimpleForm from '@/components/TodoSimpleForm.vue'\r\n  import TodoList from '@/components/TodoList.vue'\r\n  import axios from 'axios'\r\n  import Toast from '@/components/Toast.vue';\r\n\r\n\r\n  export default {\r\n    name: 'App',\r\n    components: {\r\n      TodoSimpleForm,\r\n      TodoList\r\n\r\n    },\r\n    setup() {\r\n      const toggle = ref(false);\r\n\r\n      const todos = ref([]);\r\n      const numOfTodos = ref(0);\r\n      const limit = 5;\r\n      const curPage = ref(1);\r\n      const searchText = ref('');\r\n\r\n      const showToast = ref(false);\r\n      const toastMessage = ref('');\r\n      const toastAlertType = ref('');\r\n\r\n\r\n      const numOfPages = computed(()=>{\r\n        return Math.ceil(numOfTodos.value/limit)\r\n      })\r\n\r\n      const getTodo = async (page = curPage.value) => {\r\n        //curPage.value = page;\r\n        try {\r\n          console.log(page)\r\n          const res = await axios.get(\r\n            `http://localhost:3000/todos?_sort=id&_order=desc&subject_like=${searchText.value}&_page=${page}&_limit=${limit}`\r\n            )\r\n          todos.value = res.data;\r\n          numOfTodos.value = res.headers['x-total-count'];\r\n        } catch (err) {\r\n          console.error(err)\r\n          triggerToast(err, 'danger');\r\n        }\r\n      }\r\n      getTodo();\r\n\r\n      const addTodo = async (todo) => {\r\n        try {\r\n          const res = await axios.post('http://localhost:3000/todos', {\r\n            subject: todo.subject,\r\n            completed: todo.completed,\r\n          })\r\n          todos.value.push(res.data);\r\n          getTodo();\r\n        } catch (err) {\r\n          console.error(err)\r\n          triggerToast(err, 'danger');\r\n        }\r\n\r\n      }\r\n      const deleteTodo = async (index) => {\r\n        const id = todos.value[index].id;\r\n        try {\r\n          await axios.delete('http://localhost:3000/todos/' + id)\r\n\r\n          getTodo(1);\r\n\r\n        } catch (err) {\r\n          console.error(err)\r\n          triggerToast(err, 'danger');\r\n        }\r\n\r\n      }\r\n      const onToggle = () => {\r\n        toggle.value = !toggle.value;\r\n      };\r\n\r\n      const toggleTodo = async (index, checked) => {\r\n        const id = todos.value[index].id;\r\n        try {\r\n          await axios.patch('http://localhost:3000/todos/' + id, {\r\n            //completed: !todos.value[index].completed\r\n            completed: checked\r\n          })\r\n          //todos.value[index].completed = !todos.value[index].completed\r\n          todos.value[index].completed = checked\r\n\r\n        } catch (err) {\r\n          console.error(err)\r\n        }\r\n      }\r\n\r\n      let timeout= null;\r\n      const searchTodo = () => {\r\n         getTodo(1);\r\n      }\r\n\r\n\r\n      watch(searchText, () => {\r\n        clearTimeout(timeout);\r\n        timeout = setTimeout(()=>{\r\n          getTodo(1);\r\n        }, 1000)\r\n      })\r\n\r\n  \r\n      const filteredTodos = computed(() => {\r\n        if (searchText.value) {\r\n          return todos.value.filter(todo => {\r\n            return todo.subject.includes(searchText.value)\r\n          });\r\n        }\r\n        return todos.value;\r\n      })\r\n\r\n      const triggerToast = (message, type = 'success') => {\r\n          showToast.value = true;\r\n          toastAlertType.value=type;\r\n          toastMessage.value=message;\r\n\r\n          setTimeout(() => {\r\n\r\n            toastMessage.value='';\r\n            showToast.value= false;\r\n            toastAlertType.value='';\r\n            \r\n          }, 3000)\r\n        };\r\n\r\n\r\n      return {\r\n        searchTodo,\r\n        todos,\r\n        getTodo,\r\n        addTodo,\r\n        deleteTodo,\r\n        toggleTodo,\r\n        onToggle,\r\n        toggle,\r\n        searchText,\r\n        filteredTodos,\r\n        numOfPages,\r\n        curPage,\r\n        Toast,\r\n        showToast,\r\n        toastMessage,\r\n        toastAlertType,\r\n        triggerToast,\r\n\r\n      }\r\n    },\r\n  }\r\n</script>\r\n\r\n<style scoped>\r\nnav a{\r\n  cursor:pointer;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}